<p>This example demonstrates Caja's tamed version of
<code>swfobject.embedSWF()</code>.</p>

<p>Demonstrations of &lt;embed&gt; and &lt;object&gt; are in the
"Embed Flash 2" example.</p>

<p>Caja does not allow Flash apps to have direct script access.
<code>ExternalInterface.call()</code> is denied by Flash's security sandbox.</p>

<p>However, Flash apps can use Caja's Flash bridge API instead.</p>

<div class="module">
  <h4>BridgeOblivious.swf (<a id="bridgeObliviousSource">source</a>)</h4>
  <div id="bridgeOblivious">(BridgeOblivious.swf replaces this)</div>
</div>

<div class="module">
  <h4>BridgeAware.swf (<a id="bridgeAwareSource">source</a>)</h4>
  <div id="bridgeAware">(BridgeAware.swf replaces this)</div>
  <div>
    <button onclick="callFlash()">Call Flash from JS</button>
  </div>
</div>

<div style="clear:both"></div>

<div class="module yt-module">
  <h4>YouTube video</h4>
  <div id="youtube">(YouTube video replaces this)</div>
</div>

<script type="text/javascript">
  // This demo uses SWF files from the Caja repository,
  // because Flash sandboxing requires the SWF to be on
  // a site different from the container.

  var rev = '5060';
  var demoDir = '/trunk/src/com/google/caja/flash/tests/';
  var rawLocation =
      'http://google-caja.googlecode.com/svn-history/r' + rev + demoDir;
  var prettyLocation =
      'http://code.google.com/p/google-caja/source/browse' + demoDir;
  var counter = 0;

  swfobject.embedSWF(
      rawLocation + 'BridgeOblivious.swf',
      'bridgeOblivious', '350', '300');
  document.getElementById('bridgeObliviousSource').href =
      prettyLocation + 'BridgeOblivious.mxml?r=' + rev;

  swfobject.embedSWF(
      rawLocation + 'BridgeAware.swf',
      'bridgeAware', '350', '300');
  document.getElementById('bridgeAwareSource').href =
      prettyLocation + 'BridgeAware.mxml?r=' + rev;

  swfobject.embedSWF(
      'http://www.youtube.com/v/unhiT2D6WvE',
      'youtube', '480', '390');

  function message(varargs) {
    alert(Array.prototype.join.call(arguments, ','));
  }

  function callFlash() {
    var o = document.getElementById('bridgeAware');
    // TODO(felix8a): test multiple args
    o.message(o.upper('call Flash from JS ' + (counter++)));
  }
</script>

<style>
  .module {
    background: #eee;
    border: 1px solid #ccc;
    float: left;
    margin: 0 9px 9px 0;
    padding: 9px;
  }
  h4 {
    margin-top: 0;
  }
  p {
    margin: 0 9px 1em 0;
    max-width: 40em;
  }
</style>
